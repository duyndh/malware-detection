import enum
import os

OPCODE_RANGE = (256 + 1 + 14)


class ModeEnum(enum.Enum):
    MINE = 0
    TRAIN = 1
    SCAN = 2

    @classmethod
    def get_index(cls, type):
        return list(cls).index(type)

    @classmethod
    def get_name(cls, index):
        names = [
            "Mine",
            "Train",
            "Scan"
        ]
        return names[index]


class FeatureEnum(enum.Enum):
    TF = 0
    TF_IDF = 1
    PR = 2

    @classmethod
    def get_index(cls, type):
        return list(cls).index(type)

    @classmethod
    def get_name(cls, index):
        names = [
            "TF",
            "TF-IDF",
            "PR"
        ]
        return names[index]


class ClassifierEnum(enum.Enum):
    KNN = 0,
    SVM = 1,
    LogisticRegression = 2,
    NeuralNetwork = 3,
    NaiveBayes = 4,
    QDA = 5,
    LDA = 6,
    DecisionTree = 7,
    RandomForest = 8,
    ExtraTrees = 9,
    AdaBoost = 10,
    GradientBoosting = 11

    @classmethod
    def get_index(cls, type):
        return list(cls).index(type)

    @classmethod
    def get_name(cls, index):
        names = [
            "KNN",
            "SVM",
            "LogisticRegression",
            "NeuralNetwork",
            "NaiveBayes",
            "QDA",
            "LDA",
            "DecisionTree",
            "RandomForest",
            "ExtraTrees",
            "AdaBoost",
            "GradientBoosting"
        ]
        return names[index]


class TargetType(enum.Enum):
    FILES = 0
    DIRECTORY = 1

    @classmethod
    def get_index(cls, type):
        return list(cls).index(type)

    @classmethod
    def get_name(cls, index):
        names = [
            "Files",
            "Directory"
        ]
        return names[index]


root_dir = "c:/"  #"/content/drive/MyDrive/Colab Notebooks/DemoDatasets/"


class GlobalVars:

    # Required
    mode_id = ModeEnum.get_index(ModeEnum.TRAIN)

    # Train
    feature_id = FeatureEnum.get_index(FeatureEnum.PR)
    sequence_len = 2
    test_ratio = 0.2
    reduced_size = 64
    benign_dirs = [root_dir + x for x in ["X/E", "X/F", "X/A", "X/B", "X/C", "X/D"]]
    benign_limit = 50
    malware_dirs = [root_dir + x for x in ["Y/Y", "Y/YX"]]
    malware_limit = 50
    classifier_ids = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11]

    output_dir = "c:/temp/output"  #"/content/drive/MyDrive/Colab Notebooks/Output" #"./Output"

    # Predict
    target_type_id = 0  #TargetType.get_index(TargetType.FILES)
    target_paths = []
    clf_path = ""
    scl_path = ""
    dcp_path = ""
    ext_path = ""

    # Private
    limit_size = 1024 * 1024  # 1MB
    limit_len = 1024 * 100
    k_fold = 5

    # Test
    benign_test_dirs = None
    benign_test_limit = 0
    malware_test_dirs = None
    malware_test_limit = 0



