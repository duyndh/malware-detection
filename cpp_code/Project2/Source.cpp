#include "pch.h"
#include "Wrapper.h"
#include "GraphBuilder.h"

void WINAPI EntryPoint()
{
	MessageBoxA(NULL, "Hello", NULL, MB_OK);
}

void WINAPI BuildGraph(const std::string& strCsvFilePath, const std::string& strOutputDirectory)
{
	GraphBuilder graphBuilder(strCsvFilePath);
	graphBuilder.Build();
	//graphBuilder.PrintGraph();
	graphBuilder.ExportCsv(strOutputDirectory);
}

void WINAPI BuildGraphDataset(const std::string& strInputDirectory, const std::string& strOutputDirectory)
{
	std::cout << "Directory: " << strInputDirectory << std::endl;
	auto liPaths = Wrapper::RecursiveEnumFiles(strInputDirectory, { CSV_EXT });
	std::cout << "Total: " << liPaths.size() << std::endl;

	size_t iPath = 1;
	for (auto& strPath : liPaths)
	{
		std::cout << iPath << "/" << liPaths.size() << ": " << strPath << std::endl;

		try
		{
			BuildGraph(strPath, strOutputDirectory);
		}
		catch (std::exception ex) {}
		
		iPath++;
	}

	std::cout << "Done" << std::endl;
}
