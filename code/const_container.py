import platform
import os
import enum

dataset_version = 1
using_colab = True

collect_benign = True
raw_file_count_limit = 50000
opcode_file_count_limit = 50000

train_file_count_limit = 1000

try_benign_file_count_limit = train_file_count_limit
try_malware_file_count_limit = train_file_count_limit

file_size_limit = 1024 * 1024
test_ratio = 0.1

max_feature_size = 256
reduced_feature_size = 64


class FeatureMethod(enum.Enum):
   Raw1 = 1
   Raw2 = 2
   TF1 = 3


training_feature_method = FeatureMethod.TF1

root_dir = ""
root_dataset_dir = ""
if platform.system() == 'Linux' and not using_colab:
    root_dir = os.path.expanduser("~/Downloads")
    root_dataset_dir = root_dir
elif platform.system() == 'Windows' and not using_colab:
    root_dir = os.path.expandvars("%SystemDrive%\\Temp")
    root_dataset_dir = root_dir
else:
    root_dir = "./"
    root_dataset_dir = "/content/drive/MyDrive/Colab Notebooks/V" + str(dataset_version)

raw_dataset_csv_file_name = "_dataset.csv"
tmp_raw_file_path = os.path.join(root_dir, "_tmp_raw.csv")
tmp_filtered_file_path = os.path.join(root_dir, "_tmp_data.csv")


benign_scan_dirs = [
    os.path.expandvars("%ProgramFiles%"),
    os.path.expandvars("%ProgramFiles(x86)%"),
    os.path.expandvars("%WinDir%")
]

malware_scan_dirs = [
    os.path.join(root_dir, "Virus.Win")
]

benign_scan_exts = [ ".acm", ".ax", ".cpl", ".dll", ".drv", ".efi", ".exe", ".mui", ".ocx", ".scr", ".sys", ".tsp" ]
malware_scan_exts = None

raw_benign_dataset_dir_x86 = os.path.join(root_dir, "benign_dataset_x86")
raw_benign_dataset_dir_x64 = os.path.join(root_dir, "benign_dataset_x64")
raw_malware_dataset_dir_x86 = os.path.join(root_dir, "malware_dataset_x86")
raw_malware_dataset_dir_x64 = os.path.join(root_dir, "malware_dataset_x64")

opcode_benign_dataset_csv_file_path_x86 = os.path.join(root_dataset_dir, "benign_opcodes_x86.csv")
opcode_benign_dataset_csv_file_path_x64 = os.path.join(root_dataset_dir, "benign_opcodes_x64.csv")

opcode_malware_dataset_csv_file_path_x86 = os.path.join(root_dataset_dir, "malware_opcodes_x86.csv")
opcode_malware_dataset_csv_file_path_x64 = os.path.join(root_dataset_dir, "malware_opcodes_x64.csv")

x64_machine = 0x8664
x86_machine = 0x14c