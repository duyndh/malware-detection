import numpy as np

class FeatureExtractor:

    @staticmethod
    def extract_matrix(opcodes):

        op_matrix = [[0 for x in range(256)] for y in range(256)]

        for op_index in range(1, len(opcodes)):
            src_op = opcodes[op_index - 1]
            dst_op = opcodes[op_index]
            op_matrix[src_op][dst_op] += 1

        return np.array(op_matrix).flatten()

    @staticmethod
    def extract_frequency(opcodes, scale_to_ratio):

        op_frequencies = [0 for x in range(256)]
        for opcode in opcodes:
          op_frequencies[opcode] += 1

        if scale_to_ratio:
          for op_index in range(len(op_frequencies)):
              op_frequencies[op_index] /= len(opcodes)

        return op_frequencies