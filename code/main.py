from dataset_generator import *

def generate_dataset():

    if False:
        DatasetGenerator.generate(
            [
                os.path.expandvars("%ProgramFiles%"),
                os.path.expandvars("%ProgramFiles(x86)%"),
                os.path.expandvars("%WinDir%")
            ],
            [
                ".acm", ".ax", ".cpl", ".dll", ".drv", ".efi", ".exe", ".mui", ".ocx", ".scr", ".sys", ".tsp"
            ],
            os.path.expandvars("%SystemDrive%\\Temp\\benign_dataset"),
            "_dataset.csv",
            1000,
            1024 * 1024,
            os.path.expandvars("%SystemDrive%\\Temp\\_raw_files.csv"),
            os.path.expandvars("%SystemDrive%\\Temp\\_filtered_files.csv")
        )

    if False:
        DatasetGenerator.generate(
            [
                os.path.expanduser("~/Downloads/Virus.Win")
            ],
            None,
            os.path.expanduser("~/Downloads/malware_dataset"),
            "_dataset.csv",
            1000,
            1024 * 1024,
            os.path.expanduser("~/Downloads/_raw_files.csv"),
            os.path.expanduser("~/Downloads/_filtered_files.csv")
        )

    pass

def load_dataset():

    # Benign dataset
    benign_file_paths = DatasetGenerator.load(os.path.expanduser("~/Downloads/benign_dataset"), "_dataset.csv", [332],
                                              200, 1024 * 1024)

    disasm = DisAssembler.disassemble(benign_file_paths[0])

    print(disasm)

    pass

if __name__ == '__main__':

    if False:
        generate_dataset()
    else:
        load_dataset()

    pass