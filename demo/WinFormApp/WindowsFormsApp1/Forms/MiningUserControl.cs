using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using System.IO;

namespace WindowsFormsApp1.Controls
{
    public partial class MiningUserControl : UserControl
    {
        public MiningUserControl()
        {
            InitializeComponent();
        }

        public enum DataFormatEnum
        {
            Raw,
            Assembly,
            Standard,
            Graph
        }

        public static readonly string[] DATA_FORMAT_VALUES = new string[]
        {
            "Raw",
            "Assembly",
            "Standard",
            "Graph"
        };
        
        protected override void OnLoad(EventArgs e)
        {
            for (int iFormat = 0; iFormat < DATA_FORMAT_VALUES.Length - 1; iFormat++)
                this.srcFormatComboBox.Items.Add(DATA_FORMAT_VALUES[iFormat]);
            this.srcFormatComboBox.SelectedIndex = 0;
        }

        private void startButton_Click(object sender, EventArgs e)
        {
            try
            {
                if (!Directory.Exists(this.srcLocationTextBox.Text))
                    throw new Exception("Not found: Source location");
                
                if (!Directory.Exists(this.dstLocationTextBox.Text))
                    throw new Exception("Not found: Destination location");

                if (!DATA_FORMAT_VALUES.Contains(this.srcFormatComboBox.SelectedItem)
                    || !DATA_FORMAT_VALUES.Contains(this.dstFormatComboBox.SelectedItem))
                    throw new Exception("Invalid: Data format");

                if (this.srcFormatComboBox.SelectedIndex >= Array.IndexOf(DATA_FORMAT_VALUES, this.dstFormatComboBox.SelectedItem))
                    throw new Exception("Invalid: Data format");

                //

            } catch (Exception ex)
            {
                MessageBox.Show(ex.Message);
            }
        }

        private void selectSrcLocationButton_Click(object sender, EventArgs e)
        {
            using (var dialog = new FolderBrowserDialog())
            {
                DialogResult result = dialog.ShowDialog();

                if (result == DialogResult.OK && !string.IsNullOrWhiteSpace(dialog.SelectedPath))
                    this.srcLocationTextBox.Text = dialog.SelectedPath;
            }
        }

        private void selectDstLocationButton_Click(object sender, EventArgs e)
        {
            using (var dialog = new FolderBrowserDialog())
            {
                DialogResult result = dialog.ShowDialog();

                if (result == DialogResult.OK && !string.IsNullOrWhiteSpace(dialog.SelectedPath))
                    this.dstLocationTextBox.Text = dialog.SelectedPath;
            }
        }

        private void srcFormat_SelectedValueChanged(object sender, EventArgs e)
        {
            this.dstFormatComboBox.Items.Clear();
            for (int iFormat = this.srcFormatComboBox.SelectedIndex + 1; iFormat < DATA_FORMAT_VALUES.Length; iFormat++)
                this.dstFormatComboBox.Items.Add(DATA_FORMAT_VALUES[iFormat]);
            this.dstFormatComboBox.SelectedIndex = 0;
        }
    }
}
