using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using WindowsFormsApp1.Controllers;
using WindowsFormsApp1.Controls;
using WindowsFormsApp1.UserControls;

namespace WindowsFormsApp1
{
    public partial class Home : Form
    {
        private Home()
        {
            InitializeComponent();
        }

        private static Home _instance = null;

        public static Home GetInstance()
        {
            if (_instance == null)
                _instance = new Home();

            return _instance;
        }

        public enum NavigationOptionEnum
        {
            NONE,
            FILES,
            PROCESSES,
            MINING,
            TRAINING,
            SETTINGS,
        }
        private const NavigationOptionEnum DEFAULT_NAV_OPTION = NavigationOptionEnum.TRAINING;

        private NavigationOptionEnum _currentNavOption = NavigationOptionEnum.NONE;
        private Color DEFAULT_SELECTED_NAV_BUTTON_BACK_COLOR = SystemColors.GradientActiveCaption;

        private Button[] _navButtons = null;
        
        private UserControl[] _navUserControls = null;
        //public UserControl[] GetNavUserControls() { return _navUserControls; }

        private MiningController _miningController = new MiningController();
        public MiningController GetMiningController() { return _miningController; }

        private TrainingController _trainingController;
        public TrainingController GetTrainingController() { return _trainingController; }

        private AppController _appController = new AppController();
        public AppController GetAppController() { return _appController; }

        protected override void OnLoad(EventArgs e)
        {
            _navButtons = new Button[]
            {
                null,
                this.filesButton,
                this.processesButton,
                this.miningButton,
                this.trainingButton,
                this.settingsButton
            };
            foreach (Button btn in _navButtons)
            {
                if (btn != null)
                {
                    btn.FlatAppearance.MouseOverBackColor = btn.FlatAppearance.MouseDownBackColor = DEFAULT_SELECTED_NAV_BUTTON_BACK_COLOR;
                }
            }

            _navUserControls = new UserControl[]
            {
                null,
                null,
                null,
                new MiningUserControl(),
                new TrainingUserControl(),
                null
            };

            _navButtons[(int)DEFAULT_NAV_OPTION].PerformClick();
            _trainingController = new TrainingController((TrainingUserControl)_navUserControls[(int)NavigationOptionEnum.TRAINING]);
        }

        private void RefressNavButtons()
        {
            foreach (Button btn in _navButtons)
            {
                if (btn != null)
                {
                    btn.BackColor = SystemColors.Control;
                }
            }
            this.splitContainer1.Panel2.Controls.Clear();
        }

        private void miningButton_Click(object sender, EventArgs e)
        {
            this._currentNavOption = NavigationOptionEnum.MINING;
            RefressNavButtons();

            this._navButtons[(int)_currentNavOption].BackColor = DEFAULT_SELECTED_NAV_BUTTON_BACK_COLOR;            
            this.splitContainer1.Panel2.Controls.Add(_navUserControls[(int)_currentNavOption]);
        }

        private void trainingButton_Click(object sender, EventArgs e)
        {
            this._currentNavOption = NavigationOptionEnum.TRAINING;
            RefressNavButtons();

            this._navButtons[(int)_currentNavOption].BackColor = DEFAULT_SELECTED_NAV_BUTTON_BACK_COLOR;
            this.splitContainer1.Panel2.Controls.Add(_navUserControls[(int)_currentNavOption]);
        }
    }
}
