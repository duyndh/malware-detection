#pragma once
#include "pch.h"

class Disassembler
{
private:
	bool GetCodeSectionData();
	bool Disassembly();

	csh m_cs_handle = NULL;
	std::vector<BYTE> m_file_data;
	
	std::list<std::tuple<
		DWORD64,
		BYTE,
		std::string,
		std::list<BYTE>,
		std::list<DWORD64>,
		std::list<BYTE>
		>> m_instructions;

	LPBYTE m_shellcode_data_ptr = NULL;
	DWORD m_shellcode_data_size = 0;
	
public:
	Disassembler();
	~Disassembler();
	
	bool Disassembly(const std::string& major_file_path_str, const std::string& minor_file_path_str);
	void Export(const std::string output_file_path_str);
	
};

